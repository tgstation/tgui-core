let t;import*as e from"./keycodes.js";class i{listeners;constructor(){this.listeners={}}on(t,e){this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e)}off(t,e){let i=this.listeners[t];if(!i)throw Error(`There is no listeners for "${t}"`);this.listeners[t]=i.filter(t=>t!==e)}emit(t,...e){let i=this.listeners[t];if(i)for(let t=0,s=i.length;t<s;t+=1)(0,i[t])(...e)}clear(){this.listeners={}}}let s=new i,r=!1,n=(t={})=>{r=!!t.ignoreWindowFocus},o=!0;function l(e,i){if(r){o=!0;return}if(t&&(clearTimeout(t),t=null),i){t=setTimeout(()=>l(e));return}o!==e&&(o=e,s.emit(e?"window-focus":"window-blur"),s.emit("window-focus-change",e))}let d=null;function u(t){let e=String(t.tagName).toLowerCase();return"input"===e||"textarea"===e}function h(){d&&(d.removeEventListener("blur",h),d=null)}let c=null,a=null,f=[];function w(t){f.push(t)}function y(t){let e=f.indexOf(t);e>=0&&f.splice(e,1)}window.addEventListener("mousemove",t=>{let e=t.target;e!==a&&(a=e,function(t){if(d||!o)return;let e=document.body;for(;t&&t!==e;){if(f.includes(t)){if(t.contains(c))return;c=t,t.focus();return}t=t.parentElement}}(e))}),window.addEventListener("focusin",t=>{var e;a=null,c=t.target,l(!0),u(t.target)&&(e=t.target,h(),(d=e).addEventListener("blur",h))}),window.addEventListener("focusout",()=>{a=null,l(!1,!0)}),window.addEventListener("blur",()=>{a=null,l(!1,!0)}),window.addEventListener("beforeunload",()=>{l(!1)});let m={};class E{event;type;code;ctrl;shift;alt;repeat;_str;constructor(t,e,i){this.event=t,this.type=e,this.code=t.keyCode,this.ctrl=t.ctrlKey,this.shift=t.shiftKey,this.alt=t.altKey,this.repeat=!!i}hasModifierKeys(){return this.ctrl||this.alt||this.shift}isModifierKey(){return this.code===e.KEY_CTRL||this.code===e.KEY_SHIFT||this.code===e.KEY_ALT}isDown(){return"keydown"===this.type}isUp(){return"keyup"===this.type}toString(){return this._str||(this._str="",this.ctrl&&(this._str+="Ctrl+"),this.alt&&(this._str+="Alt+"),this.shift&&(this._str+="Shift+"),this.code>=48&&this.code<=90?this._str+=String.fromCharCode(this.code):this.code>=e.KEY_F1&&this.code<=e.KEY_F12?this._str+=`F${this.code-111}`:this._str+=`[${this.code}]`),this._str}}document.addEventListener("keydown",t=>{if(u(t.target))return;let e=t.keyCode,i=new E(t,"keydown",m[e]);s.emit("keydown",i),s.emit("key",i),m[e]=!0}),document.addEventListener("keyup",t=>{if(u(t.target))return;let e=t.keyCode,i=new E(t,"keyup");s.emit("keyup",i),s.emit("key",i),m[e]=!1});export{i as EventEmitter,E as KeyEvent,w as addScrollableNode,u as canStealFocus,s as globalEvents,y as removeScrollableNode,n as setupGlobalEvents};